---
title: Moderated Sessions
description: Session moderation with RBAC and humans
h1: Moderated Sessions
---

This is an upcoming feature expected to land in Teleport 8.2.

## Introduction

Moderated sessions is a feature that allows Teleport administrators to define policies
that define requirements for other users to be present in a Server or Kubernetes Access session.

Moderated Sessions is useful in the following scenarios:
- When you have stringent security requirements and need to have people watching over sessions to production.
- When you want to share a terminal with someone else to be able to instruct or collaborate.

## Core Features

With Moderated Sessions you can:
- Join SSH and Kubernetes sessions from the terminal as an observer, moderator or peer.
- Require auditors to be present in certain sessions.
- Allow people to join your session to observe what you are doing in real-time.

## Getting Started

## Participant Modes

A participant joining a session will always have one of three modes:
- Peers can join and collaborate in a session. They can view output and send input.
- Moderators can join and watch a session, they can view output and forcefully terminate the session at will.
- Observers can join and watch a session. They cannot control the session in any way.

## RBAC

Moderated Sessions makes use of RBAC policies to allow for fine grained control over
who can join a session and whom are required to be present to start one.

The system is based around *require policies* and *allow policies*. Require policies define a set of conditions
that must be a met for a session to start/run. The allow policies that matter for a given session
are always those of user that initiated the session. Allow policies are used to define
what users a session may join and under what conditions.

### Backwards compatibility with Server Access

Previously, Server Access did not have access control for whom can join a session.
To work around this, RBAC are ignored for users that only have V4 roles.
New and modified roles are created as V5 roles any having any attached V5 role will
cause the new RBAC checks to be applied to a session started by them.

### Example require policy

The policy below specifies that a given role
must have a minimum of two users with the role `auditor` and the mode `moderator` present in the session
to start it. The policy applies to SSH and Kubernetes sessions only.

When a user with this require policy starts a session, it will be pending
until the policy is fulfilled, only then does the session start.

```yaml
kind: role
metadata:
  name: prod-access
spec:
  allow:
    require_session_join:
      - name: Audtor oversight
        filter: 'contains(observer.roles, "auditor")'
        kinds: ['k8s', 'ssh']
        modes: ['moderator']
```

### Example allow policy

The following allow policy attaches to the role `auditor` and allows one to join
SSH and Kubernetes sessions started by a user with the role `prod_access` as a moderator or observer.

```yaml
kind: role
metadata:
  name: auditor
spec:
  allow:
    join_sessions:
      - name: Auditor oversight
        roles : ['prod-access']
        kinds: ['k8s', 'ssh']
        modes: ['moderator', 'observer']
```

## MFA-based presence

When `mfa_required` is set to `true` via role or cluster settings. Teleport enforces
MFA-based presence checks for moderators.

This requires that all moderators wishing to join have a configured U2F or Webauthn MFA token.
Every 30 seconds, Teleport will issue a prompt to the user in the terminal, asking them
to press their MFA token in the next 15 seconds. This will happen continously during the session
and exists so that moderators are always present and watching a given session. If no MFA input
is received within 60 seconds, the user is kicked from the session which may pause it, if RBAC
policies are no longer met.

## RFD

- [Moderated Sessions](https://github.com/gravitational/teleport/blob/master/rfd/0043-kubeaccess-multiparty.md)
